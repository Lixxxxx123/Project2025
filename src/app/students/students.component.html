<h2>B236信息列表</h2>
<div *ngIf="isLoading" class="loading">数据加载中，请稍候...</div>
<app-student-search></app-student-search>
<div class="page-container" *ngIf="!isLoading">
  <div class="left-column">
    <div class="stats-panel">
      <h3>统计信息</h3>
      <p>总人数：{{students.length}}</p>

      <div class="stat-item">
        <span class="stat-label">平均年龄：</span>
        <span class="stat-value">{{averageAge}} 岁</span>
      </div>

      <!-- 新增：性别统计 -->
      <div class="stat-item" *ngIf="genderStats">
        <span class="stat-label">性别比例：</span>
        <span class="stat-value">男 {{genderStats.male}}人 ({{genderStats.malePercentage}}%)</span>
        <span class="stat-value">女 {{genderStats.female}}人 ({{genderStats.femalePercentage}}%)</span>
      </div>

      <h4>年龄分布：</h4>
      <ul class="age-distribution">
        <li *ngFor="let item of ageDistribution">
          <span class="range">{{item.ageRange}}:</span>
          <span class="count">{{item.count}}人</span>
          <span class="percentage">{{item.percentage}}</span>
        </li>
      </ul>

      <div class="chart-container">
        <canvas #ageChart width="300" height="300"></canvas>
      </div>
    </div>
  </div>

  <div class="right-column">
    <ul class="students">
      <li *ngFor="let student of students">
        <a routerLink="/detail/{{student.id}}">
          <span class="badge">{{student.id}}</span>
          <span class="name">{{student.studentName}}</span>
        </a>
        <!-- 只保留一个删除按钮 -->
        <button class="delete-btn" title="删除学生" (click)="delete(student)">
          <i class="delete-icon">×</i>
        </button>
      </li>
    </ul>
    
    <div class="add-student">
      <h3>添加新学生</h3>
      <div class="form-group">
        <label for="new-student-id">学号：</label>
        <input id="new-student-id" #studentId placeholder="例如：20230011" />
      </div>
      
      <div class="form-group">
        <label for="new-student">姓名：</label>
        <input id="new-student" #studentName placeholder="请输入姓名" />
      </div>
      
      <!-- 将 type="date" 改为 type="text" 并添加自定义样式类 -->
      <div class="form-group">
        <label for="studentBirthday">生日：</label>
        <input type="text" id="studentBirthday" #studentBirthday 
               placeholder="年/月/日" 
               class="form-control date-input" />
      </div>
      
      <div class="form-group">
        <label for="new-student-gender">性别：</label>
        <select id="new-student-gender" #studentGender>
          <option value="true">男</option>
          <option value="false">女</option>
        </select>
      </div>
      
      <button class="add-button" (click)="addFullStudent(studentId.value, studentName.value, studentBirthday.value, studentGender.value); studentId.value=''; studentName.value=''; studentBirthday.value=''; studentGender.value='true'">
        添加学生
      </button>
    </div>
  </div>
</div>